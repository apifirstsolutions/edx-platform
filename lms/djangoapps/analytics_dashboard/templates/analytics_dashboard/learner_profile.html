{% extends 'base_v2.html' %}

{% block content %}

{% load static %}

<style>
    .learner-profile .profile-img{
        width: 150px;
        height: 150px;
        border-radius: 50%;
        display: block;
        margin-left: auto;
        margin-right: auto;
        padding: 10px;
    }
    div.profile-details table{
        margin: 10px 0 !important;
        font-size: smaller;
    }
    .bg-ntuc{
        background-color: #1a345c;
    }
    .course-card{
        border-radius: 8px;
        font-size: smaller;
        font-weight: bold;
        overflow: auto !important;
    }
</style>

<div class="container learner-profile" >
    <div class="row">
        <div class="col-md-4 profile-details">
            <img class="profile-img" src="{% static '/img/profile_avatar_placeholder.png' %}" alt="profile image">

            <table class='table borderless table-responsive'>
                <tr>
                    <td>Username</td>
                    <td>{{ learner.username }}</td> 
                </tr>
                <tr>
                    <td>Full Name</td>
                    <td>
                        {% if learner.first_name %}
                            {{ learner.first_name }}
                        {% else %}
                        -
                        {% endif %}
                        
                        {% if learner.last_name %}
                            {{ learner.last_name }}
                        {% else %}
                        -
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td>E-mail</td>
                    <td>{{ profile.user.email }}</td>
                </tr>
                <tr>
                    <td>Year of birth</td>
                    <td>{{ profile.year_of_birth }}</td>
                </tr>
                <tr>
                    <td>Gender</td>
                    {% if profile.gender == 'm' %}
                    <td>Male</td>
                    {% elif profile.gender == 'f' %}
                    <td>Female</td>
                    {% else %}
                    <td>Others / Prefer Not to say</td>
                    {% endif %}
                </tr>
                <tr>
                    <td>Level of Education</td>
                    {% if profile.level_of_education == 'p' %}
                    <td>Doctorate</td>
                    {% elif profile.level_of_education == 'm' %}
                    <td>Master’s or professional degree</td>
                    {% elif profile.level_of_education == 'b' %}
                    <td>Bachelor’s degree</td>
                    {% elif profile.level_of_education == 'a' %}
                    <td>Associate degree</td>
                    {% elif profile.level_of_education == 'hs' %}
                    <td>Secondary/high school</td>
                    {% elif profile.level_of_education == 'jhs' %}
                    <td>Junior secondary/junior high/middle school</td>
                    {% elif profile.level_of_education == 'el' %}
                    <td>Elementary/primary school</td>
                    {% elif profile.level_of_education == None %}
                    <td>No Formal Education</td>
                    {% elif profile.level_of_education == '' %}
                    <td>Not set by user</td>
                    {% endif %}
                </tr>
                <tr>
                    <td>Status</td>
                    <td>
                        {% if learner.is_active %}
                            <span class="badge bg-success">Active</span>
                        {% else %}
                            <span class="badge bg-secondary">Inactive</span>
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td>Courses atteneded </td>
                    <td>{{course_enrolled.count}}</td>
                </tr>
                <tr>
                    <td>Date joined</td>
                    <td>{{ learner.date_joined|date:"j M Y" }}</td>
                </tr>
            </table>
        </div>

        <div class="col-md-8 mt-3">
            <!-- Cards  -->
            <!-- <div class="container "> -->
                <div class="row mb-4">
                    <!-- Courses Enrolled Card -->
                    <div class="col-sm-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h6 class="card-title text-uppercase">Courses Enrolled</h5>
                                    <p class="card-text">{{ course_enrolled.count }}</p>
                                    <!-- <a href="#" class="btn btn-primary">Go somewhere</a> -->
                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-sm-1"></div> -->
    
                    <!-- Courses In Progress -->
                    <div class="col-sm-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h6 class="card-title text-uppercase">Courses In Progress</h5>
                                    <p class="card-text">{{ course_enrolled.count }}</p>
                                    <!-- <a href="#" class="btn btn-primary">Go somewhere</a> -->
                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-sm-1"></div> -->
    
                    <!-- Courses Completed -->
                    <div class="col-sm-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h6 class="card-title text-uppercase">Courses Completed</h5>
                                    <p class="card-text">-</p>
                                    <!-- <a href="#" class="btn btn-primary">Go somewhere</a> -->
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-1"></div>
                </div>
            <!-- </div> -->

            <h5>Enrolled Courses</h3>
            {% for course in courses %}
                
                <div class="card mb-3 course-card" >
                    <!-- <div class="card-header">Header</div> -->
                    <div class="card-body pb-0">
                        <table class="table table-responsive table-borderless table-sm">
                            <tr>
                                <td class="text-muted text-wrap">
                                    <small class="text-muted text-wrap">{{course.id}}</small>
                                    <!-- <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p> -->
                                </td>
                                <!-- <td></td> -->
                                <td class="text-center">
                                    Date Enrolled
                                </td>
                                <td class="text-center">
                                    Course completed             
                                </td>
                                <td class="text-center">
                                    Overall progress
                                </td>
                            </tr>
                            <tr class="text-center align-middle">
                                <td class="col-6">
                                    <h6 class="card-title text-start"> 
                                        <a class="text-secondary" href="">
                                            {{ course.display_name }}
                                        </a>
                                    </h6>
                                </td>
                                <td class="col-2">10 Mar 2021</td>
                                <td class="col-2">-</td>
                                <td class="col-2" id="{{ course.id }}_col"></td>
                            </tr>
                        </table>
                    </div>
                    <div class="progress" style="border-radius: 0; height: 5px;">
                        <div class="progress-bar bg-ntuc" id="{{ course.id }}" role="progressbar"  aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
            {% empty %}
                <h6>Explore our biggest collection of courses</h6>
            {% endfor %}
            <!-- <div style="background-color: hotpink; height: 200px;"></div> -->
        </div>
    </div>
    <script>
        var courses = [{% for c in courses %} '{{ c.id|safe }}', {% endfor %}]
        var i = 0;

        for(i = 0; i<courses.length; i++) {
            const id_col = courses[i] + "_col"
            const prog = Math.floor(Math.random() * 100)
            document.getElementById(id_col).innerHTML= prog + "%";
            document.getElementById(courses[i]).style.width =  prog + "%";
        }
    </script>
</div>

{% endblock %}